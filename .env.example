# =============================================================================
# AWGP ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to git - it's in .gitignore
# 
# For Docker secrets (more secure), use the _FILE variants:
#   KEYCLOAK_CLIENT_SECRET_FILE=/run/secrets/keycloak_secret
#   DATABASE_URL_FILE=/run/secrets/database_url
# =============================================================================

# =============================================================================
# KEYCLOAK AUTHENTICATION (Required)
# =============================================================================
# Your Keycloak server URL
KEYCLOAK_URL=http://192.168.1.206:8080

# The realm name (case-sensitive)
KEYCLOAK_REALM=AWGP

# The client ID we created
KEYCLOAK_CLIENT_ID=awgp-api

# The client secret (copy from Keycloak Credentials tab)
# SECURITY: Use Docker secrets in production:
#   KEYCLOAK_CLIENT_SECRET_FILE=/run/secrets/keycloak_secret
KEYCLOAK_CLIENT_SECRET=__PASTE_YOUR_KEYCLOAK_CLIENT_SECRET_HERE__

# =============================================================================
# DATABASE - PostgreSQL (Required)
# =============================================================================
# Connection details for your existing Postgres
# If using Docker Compose with existing Postgres:
#   DB_HOST=postgres
#   DB_PORT=5432
# If using external Postgres:
#   DB_HOST=192.168.1.xxx

DB_HOST=postgres
DB_PORT=5432
DB_NAME=awgp
DB_USER=awgp
DB_PASSWORD=__YOUR_POSTGRES_PASSWORD_HERE__

# Full connection string (auto-generated from above)
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# =============================================================================
# REDIS CACHE (Required)
# =============================================================================
# Your existing Redis server
# If using Docker Compose with existing Redis:
#   REDIS_HOST=redis
# If using external Redis:
#   REDIS_HOST=192.168.1.xxx

REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=  # Leave empty if no password

# Full connection string
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# Node environment
NODE_ENV=production

# API server port and host
API_PORT=4000
API_HOST=0.0.0.0

# URL the API will be accessible at
API_URL=https://api.awgp.local

# =============================================================================
# FRONTEND SETTINGS
# =============================================================================

# The URL your frontend runs on (for CORS)
WEB_URL=https://awgp.local

# Where to find the API
VITE_API_URL=https://api.awgp.local
VITE_KEYCLOAK_URL=${KEYCLOAK_URL}

# =============================================================================
# JWT CONFIGURATION
# =============================================================================
# Generate a strong secret: openssl rand -base64 32
JWT_SECRET=__GENERATE_A_STRONG_SECRET_HERE_MINIMUM_32_CHARACTERS__
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# =============================================================================
# AI PROVIDER API KEYS (At least one required for assistants to work)
# =============================================================================

# OpenRouter (recommended - multi-provider)
OPENROUTER_API_KEY=__YOUR_OPENROUTER_KEY_HERE__

# OpenAI Direct (optional)
# OPENAI_API_KEY=sk-your-openai-key

# Anthropic (optional)
# ANTHROPIC_API_KEY=sk-ant-your-anthropic-key

# =============================================================================
# TRAEFIK / REVERSE PROXY (Required)
# =============================================================================

# The Docker network Traefik is on
TRAEFIK_NETWORK=traefik-public

# Your domain (or .local for development)
DOMAIN=awgp.local

# Full URLs
API_DOMAIN=https://api.${DOMAIN}
WEB_DOMAIN=https://${DOMAIN}

# =============================================================================
# COST MANAGEMENT
# =============================================================================

# Monthly budgets per provider (USD)
OPENROUTER_MONTHLY_BUDGET=5000
OPENAI_MONTHLY_BUDGET=3000
ANTHROPIC_MONTHLY_BUDGET=2000

# Alert thresholds
COST_ALERT_ENABLED=true
COST_ALERT_THRESHOLD_50=true
COST_ALERT_THRESHOLD_75=true
COST_ALERT_THRESHOLD_90=true
COST_ALERT_THRESHOLD_95=true

# =============================================================================
# SECURITY
# =============================================================================

# Rate limiting (requests per minute)
RATE_LIMIT_GENERAL=100
RATE_LIMIT_COSTLY=20
RATE_LIMIT_AUTH=5

# Allowed CORS origins (comma-separated)
CORS_ORIGINS=https://awgp.local,https://api.awgp.local

# Session secret (different from JWT_SECRET)
SESSION_SECRET=__GENERATE_A_DIFFERENT_SECRET_HERE__

# =============================================================================
# OPTIONAL INTEGRATIONS
# =============================================================================

# Teleport (for infrastructure access)
# TELEPORT_PROXY_URL=https://teleport.yourdomain.com:3080
# TELEPORT_APP_TOKEN=__OPTIONAL__

# N8N Webhook (for automation)
# N8N_WEBHOOK_URL=http://n8n:5678/webhook/awgp

# Qdrant (for vector search/AI memory)
# QDRANT_URL=http://qdrant:6333

# =============================================================================
# DEVELOPMENT (Uncomment for local dev)
# =============================================================================
# NODE_ENV=development
# LOG_LEVEL=debug
# DEBUG=true
